ruleId: aws-security-and-identity-compliance-secretsmanager-secret-periodic-rotation
cloudProvider: aws
description: >
      - Checks whether AWS Secrets Manager secret has been rotated within 90 days.
      - Insecure assets have not been rotated
      - secure asset has been rotated within 90 days
insecureAssets:
  verysecret: >
    [ {
      "documentId" : "lrX7pshiOYmI8eBBpFKzKw",
      "arn" : "verysecret",
      "resourceName" : "verysecret",
      "resourceId" : null,
      "resourceType" : "AWS::SecretsManager",
      "awsRegion" : "us-east-1",
      "awsAccountId" : "00000000000",
      "createdIso" : "2022-04-04T13:50:20.166Z",
      "updatedIso" : "2022-04-08T12:38:52.697965Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "arn" : "arn:aws:secretsmanager:us-east-1:476384142167:secret:verysecret-oqOJsX",
        "name" : "verysecret",
        "description" : null,
        "kmsKeyId" : "arn:aws:kms:us-east-1:476384142167:alias/kmslogtest",
        "rotationEnabled" : null,
        "rotationLambdaARN" : null,
        "rotationRules" : null,
        "lastRotatedDate" : "2021-01-08T00:00:00Z",
        "lastChangedDate" : "2022-04-04T15:14:05.716Z",
        "lastAccessedDate" : "2022-04-08T00:00:00Z",
        "deletedDate" : null,
        "tags" : [ ],
        "versionIdsToStages" : {
          "51a23f48-b637-47aa-87ea-8357282b6c2d" : [ "AWSPREVIOUS" ],
          "c4b1f670-c867-42b2-8458-f7ed3497804c" : [ "AWSCURRENT" ]
        },
        "owningService" : null,
        "createdDate" : "2022-04-04T13:50:20.166Z",
        "primaryRegion" : null,
        "replicationStatus" : null
      },
      "supplementaryConfiguration" : {
        "SecretList" : {
          "secretList" : [ {
            "arn" : "arn:aws:secretsmanager:us-east-1:476384142167:secret:verysecret-oqOJsX",
            "name" : "verysecret",
            "description" : null,
            "kmsKeyId" : "arn:aws:kms:us-east-1:476384142167:alias/kmslogtest",
            "rotationEnabled" : null,
            "rotationLambdaARN" : null,
            "rotationRules" : null,
            "lastRotatedDate" : null,
            "lastChangedDate" : "2022-04-04T15:14:05.716Z",
            "lastAccessedDate" : "2022-04-08T00:00:00Z",
            "deletedDate" : null,
            "tags" : [ ],
            "secretVersionsToStages" : {
              "51a23f48-b637-47aa-87ea-8357282b6c2d" : [ "AWSPREVIOUS" ],
              "c4b1f670-c867-42b2-8458-f7ed3497804c" : [ "AWSCURRENT" ]
            },
            "owningService" : null,
            "createdDate" : "2022-04-04T13:50:20.166Z",
            "primaryRegion" : null
          }, {
            "arn" : "arn:aws:secretsmanager:us-east-1:476384142167:secret:noencryptsecret-aOO80g",
            "name" : "noencryptsecret",
            "description" : null,
            "kmsKeyId" : null,
            "rotationEnabled" : null,
            "rotationLambdaARN" : null,
            "rotationRules" : null,
            "lastRotatedDate" : null,
            "lastChangedDate" : "2022-04-04T13:51:05.840Z",
            "lastAccessedDate" : null,
            "deletedDate" : null,
            "tags" : [ ],
            "secretVersionsToStages" : {
              "59472c94-157e-49ce-a859-412a385300f1" : [ "AWSCURRENT" ]
            },
            "owningService" : null,
            "createdDate" : "2022-04-04T13:51:05.794Z",
            "primaryRegion" : null
          }, {
            "arn" : "arn:aws:secretsmanager:us-east-1:476384142167:secret:defaultsecret-tJ3mYk",
            "name" : "defaultsecret",
            "description" : null,
            "kmsKeyId" : "arn:aws:kms:us-east-1:476384142167:key/cb7be2ec-5775-49d6-be13-9d25c9c33a43",
            "rotationEnabled" : null,
            "rotationLambdaARN" : null,
            "rotationRules" : null,
            "lastRotatedDate" : null,
            "lastChangedDate" : "2022-04-04T16:33:02.424Z",
            "lastAccessedDate" : null,
            "deletedDate" : null,
            "tags" : [ ],
            "secretVersionsToStages" : {
              "e8ee1936-0fab-4fd9-b2fd-939a0a612b34" : [ "AWSCURRENT" ]
            },
            "owningService" : null,
            "createdDate" : "2022-04-04T16:33:02.326Z",
            "primaryRegion" : null
          } ],
          "nextToken" : null
        }
      },
      "tags" : { },
      "discoveryMeta" : { }
      } ]
secureAssets:
  secret: >
    [ {
      "documentId" : "lrX7pshiOYmI8eBBpFKzKw",
      "arn" : "secret",
      "resourceName" : "secret",
      "resourceId" : null,
      "resourceType" : "AWS::SecretsManager",
      "awsRegion" : "us-east-1",
      "awsAccountId" : "00000000000",
      "createdIso" : "2022-04-04T13:50:20.166Z",
      "updatedIso" : "2022-04-08T12:38:52.697965Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "arn" : "arn:aws:secretsmanager:us-east-1:476384142167:secret:verysecret-oqOJsX",
        "name" : "verysecret",
        "description" : null,
        "kmsKeyId" : "arn:aws:kms:us-east-1:476384142167:alias/kmslogtest",
        "rotationEnabled" : true,
        "rotationLambdaARN" : null,
        "rotationRules" : null,
        "lastRotatedDate" : "2022-04-08T00:00:00Z",
        "lastChangedDate" : "2022-04-04T15:14:05.716Z",
        "lastAccessedDate" : "2022-04-08T00:00:00Z",
        "deletedDate" : null,
        "tags" : [ ],
        "versionIdsToStages" : {
          "51a23f48-b637-47aa-87ea-8357282b6c2d" : [ "AWSPREVIOUS" ],
          "c4b1f670-c867-42b2-8458-f7ed3497804c" : [ "AWSCURRENT" ]
        },
        "owningService" : null,
        "createdDate" : "2022-04-04T13:50:20.166Z",
        "primaryRegion" : null,
        "replicationStatus" : null
      },
      "supplementaryConfiguration" : {
        "SecretList" : {
          "secretList" : [ {
            "arn" : "arn:aws:secretsmanager:us-east-1:476384142167:secret:verysecret-oqOJsX",
            "name" : "verysecret",
            "description" : null,
            "kmsKeyId" : "arn:aws:kms:us-east-1:476384142167:alias/kmslogtest",
            "rotationEnabled" : null,
            "rotationLambdaARN" : null,
            "rotationRules" : null,
            "lastRotatedDate" : null,
            "lastChangedDate" : "2022-04-04T15:14:05.716Z",
            "lastAccessedDate" : "2022-04-08T00:00:00Z",
            "deletedDate" : null,
            "tags" : [ ],
            "secretVersionsToStages" : {
              "51a23f48-b637-47aa-87ea-8357282b6c2d" : [ "AWSPREVIOUS" ],
              "c4b1f670-c867-42b2-8458-f7ed3497804c" : [ "AWSCURRENT" ]
            },
            "owningService" : null,
            "createdDate" : "2022-04-04T13:50:20.166Z",
            "primaryRegion" : null
          }, {
            "arn" : "arn:aws:secretsmanager:us-east-1:476384142167:secret:noencryptsecret-aOO80g",
            "name" : "noencryptsecret",
            "description" : null,
            "kmsKeyId" : null,
            "rotationEnabled" : null,
            "rotationLambdaARN" : null,
            "rotationRules" : null,
            "lastRotatedDate" : null,
            "lastChangedDate" : "2022-04-04T13:51:05.840Z",
            "lastAccessedDate" : null,
            "deletedDate" : null,
            "tags" : [ ],
            "secretVersionsToStages" : {
              "59472c94-157e-49ce-a859-412a385300f1" : [ "AWSCURRENT" ]
            },
            "owningService" : null,
            "createdDate" : "2022-04-04T13:51:05.794Z",
            "primaryRegion" : null
          }, {
            "arn" : "arn:aws:secretsmanager:us-east-1:476384142167:secret:defaultsecret-tJ3mYk",
            "name" : "defaultsecret",
            "description" : null,
            "kmsKeyId" : "arn:aws:kms:us-east-1:476384142167:key/cb7be2ec-5775-49d6-be13-9d25c9c33a43",
            "rotationEnabled" : null,
            "rotationLambdaARN" : null,
            "rotationRules" : null,
            "lastRotatedDate" : null,
            "lastChangedDate" : "2022-04-04T16:33:02.424Z",
            "lastAccessedDate" : null,
            "deletedDate" : null,
            "tags" : [ ],
            "secretVersionsToStages" : {
              "e8ee1936-0fab-4fd9-b2fd-939a0a612b34" : [ "AWSCURRENT" ]
            },
            "owningService" : null,
            "createdDate" : "2022-04-04T16:33:02.326Z",
            "primaryRegion" : null
          } ],
          "nextToken" : null
        }
      },
      "tags" : { },
      "discoveryMeta" : { }
      } ]
