ruleId: aws-compute-eks-endpoint-no-public-access
cloudProvider: aws
description: >
  Insecure Assets:
   - EKS instance has  public access
  Secure asset
   - EKS cluster has no public access
insecureAssets:
  noncompliantcluster: >
    [ {
      "documentId" : "pBYt_xOyPCuv_--v9ArckQ",
      "arn" : "noncompliantcluster",
      "resourceName" : "noncompliantcluster",
      "resourceId" : null,
      "resourceType" : "AWS::EKS::Cluster",
      "awsRegion" : "us-east-1",
      "awsAccountId" : "00000000000",
      "createdIso" : null,
      "updatedIso" : "2022-04-05T13:56:08.835694Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "cluster" : {
          "name" : "noncompliantcluster",
          "arn" : "arn:aws:eks:us-east-1:476384142167:cluster/noncompliantcluster",
          "createdAt" : "2022-04-05T13:12:17.812Z",
          "version" : "1.21",
          "endpoint" : "https://2868D1D258C464A7B301A23F4CCD1FE2.gr7.us-east-1.eks.amazonaws.com",
          "roleArn" : "arn:aws:iam::476384142167:role/eksclusterrole",
          "resourcesVpcConfig" : {
            "subnetIds" : [ "subnet-bc9b61e3", "subnet-d71be5b1", "subnet-4f0ebe41", "subnet-5be56c16", "subnet-a3d21682" ],
            "securityGroupIds" : [ ],
            "clusterSecurityGroupId" : "sg-025f23f05d35112c7",
            "vpcId" : "vpc-00e2e87a",
            "endpointPublicAccess" : true,
            "endpointPrivateAccess" : false,
            "publicAccessCidrs" : [ "0.0.0.0/0" ]
          },
          "kubernetesNetworkConfig" : {
            "serviceIpv4Cidr" : "10.100.0.0/16"
          },
          "logging" : {
            "clusterLogging" : [ {
              "types" : [ "api", "audit", "authenticator", "controllerManager", "scheduler" ],
              "enabled" : false
            } ]
          },
          "identity" : {
            "oidc" : {
              "issuer" : "https://oidc.eks.us-east-1.amazonaws.com/id/2868D1D258C464A7B301A23F4CCD1FE2"
            }
          },
          "status" : "ACTIVE",
          "certificateAuthority" : {
            "data" : "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeU1EUXdOVEV6TVRnME4xb1hEVE15TURRd01qRXpNVGcwTjFvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTlpvCjVPUGVXZHFnOUprMEV0OFlENmNPOEFyS1pMemVUbFBCUzBwclI0cXNSU0JPV0M3SVpwRkk5amNZbmt1cjJkeFAKNDV6NkgzRE9PRldJOGFJVGo1VElpdFlYUTF6bnRRcE1pWlVwZUkyYmoxSThNdkJELzI0M0R5bmduYndzWHc1aApxUVpPTHUyajB3SEg5TS9uMFh6bm1iY1NQamk1N3l4cmdZVWFhdXZOUStBb0k4TjhVSzVWdEZQaUpRbXM1VXBhClA1dEUwTnRRb0YxMlpyMFMvT3pKOFBZeWIwTEwzYkxPYk5FL2NTdTlvMm9PQUplU3UwemdoSzllZFdLRVhhQTYKZlhQUHB3SXhnUkJHK2JJU1dUSE80L05yMVpPMWR1c2YrbUZqRE0yNkZWWDl0Q1gveUdacGpMVlN1dWdSQzE3YQpqT1p6ZjVNdVUrMWJFWFN1TGtzQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZCNE5ZRDJucjlzZDZKZTNrR0czU2tOUXNpaXZNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFBYmR5R3Z5Qmt4WEVQQm11MEthMFdKWU8xTlRmbHR2dzg0cDVYaUNxOHZKaWJCbmlPYQpCNFFJU2FGSnVWRXpRL2hCb2s2M3JtT3BZK2ZaTHNjMGt1MG1WcXJEMnlVa0dyWjZ0RWhiWTFiOVpGZGwwQnRJCjR5eWdBZkcvWmFKVk1FVUl0OGo4MUpVajBqV0k3ZU8xZ3pEL1pCb1lCWFJlV1JoWmQzV2NEMFg1NTRFaEFSWmkKVkozVTM5bmJ6dWpPMDVMV0JnUVdBcThHTElMeDBEOXZFV2xYNlpFZ1dtK2xCN1dKOUFlWU43SktYN2tza3R0eApLOXpaY28vZ2tDVWVmRnNZY0hUYkFFUVh6Q1VCMnIyZkpRODBaSlNsWDdWRE1wUzdNMDVKUEE3aEFpL3orQ3dwClZuWFcxTmJiS3RXb3NkbzFscHkwOWV3cVUyWlJQY1ovZm5McQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg=="
          },
          "clientRequestToken" : null,
          "platformVersion" : "eks.5",
          "tags" : { },
          "encryptionConfig" : null,
          "connectorConfig" : null
        }
      },
      "supplementaryConfiguration" : {
        "fargateProfiles" : [ ],
        "nodegroups" : [ ],
        "updates" : [ ]
      },
      "tags" : { },
      "discoveryMeta" : { }
    } ]
secureAssets:
  complaintcluster: >
    [ {
      "documentId" : "JzkRt73-MUaZQcM05pCsBw",
      "arn" : "complaintcluster",
      "resourceName" : "complaintcluster",
      "resourceId" : null,
      "resourceType" : "AWS::EKS::Cluster",
      "awsRegion" : "us-east-1",
      "awsAccountId" : "476384142167",
      "createdIso" : null,
      "updatedIso" : "2022-04-05T13:56:07.988703Z",
      "discoverySessionId" : null,
      "maxSizeInBytes" : null,
      "sizeInBytes" : null,
      "configuration" : {
        "cluster" : {
          "name" : "complaintcluster",
          "arn" : "arn:aws:eks:us-east-1:476384142167:cluster/complaintcluster",
          "createdAt" : "2022-04-05T12:19:11.758Z",
          "version" : "1.21",
          "endpoint" : "https://309DFA0858D49599798A6A7019E14906.gr7.us-east-1.eks.amazonaws.com",
          "roleArn" : "arn:aws:iam::476384142167:role/eksclusterrole",
          "resourcesVpcConfig" : {
            "subnetIds" : [ "subnet-bc9b61e3", "subnet-d71be5b1", "subnet-4f0ebe41", "subnet-5be56c16", "subnet-a3d21682" ],
            "securityGroupIds" : [ ],
            "clusterSecurityGroupId" : "sg-0cf07795265922f71",
            "vpcId" : "vpc-00e2e87a",
            "endpointPublicAccess" : false,
            "endpointPrivateAccess" : false,
            "publicAccessCidrs" : [ "0.0.0.0/0" ]
          },
          "kubernetesNetworkConfig" : {
            "serviceIpv4Cidr" : "10.100.0.0/16"
          },
          "logging" : {
            "clusterLogging" : [ {
              "types" : [ "api", "audit", "authenticator", "controllerManager", "scheduler" ],
              "enabled" : false
            } ]
          },
          "identity" : {
            "oidc" : {
              "issuer" : "https://oidc.eks.us-east-1.amazonaws.com/id/309DFA0858D49599798A6A7019E14906"
            }
          },
          "status" : "ACTIVE",
          "certificateAuthority" : {
            "data" : "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeU1EUXdOVEV5TWpVME1Wb1hEVE15TURRd01qRXlNalUwTVZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBSnBSCnBEMVQ1MlV6bE9pQ3VMbFFLVHVjSFJMSUtBdCtKVENyZTdvSUluenFJM0paLzNLUkk2SlBRK3FMYktWeUVpeksKdldTVWkyVlptT2hlUmtla1pXWllMZjVZVzVkL1hPelhpRVp3d1FjSitueHVxYUpYUmgwSkpsK28zcUlHWmc5RAp2bXk0OE8wWEJMWGpLUkpkYkszUGFhWjJFMkxSVGMvSit6YmpzZWtJMXFKalhOeG85WEZBUy83Qnp4Zzhzc3c3Clg5aERsRTFtU2RjZXZtdG1pMkFFYi9jQjBoMW5POEROM2ljclptY0NCNURVTVJkMFNraWRWZkRNM2FtM1N5dEcKZXBXM1lhaG1VNHZRM2VSZW9COWhYNlFSRGwxbWNNTFhheU9SblFzRXY5K0NUem1FWGkvVy9KRFNpcHpmMDdsbgpFays2YityL0poZUpVZUFQTTRrQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZQZTNPTDFrVElxWHE4MWFzbnh3d0xvV1JHOEZNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFBd3kwVmU5ZGFPSjQxNlV2a0RDelFTYk1zSENodk50K2tyZGNiNVhLRXh3OFJYZlZKbgp1Vm91bVRFVVMzdlBLUm1aYnJ3Qk8rV3RpTkNZM2RMNUFic2hpY0JSM09jY1lGZDlSN2M3Vnk3SWJSaXhQVStLCmpMQ3VzeW45MjYvQ3pLc3dGL3JkaEJGbFhobkpOblloOVZPMG1ld05yc01EVzdsS3FGOFFpOUVwUm9LTm1NM1UKM1RyV0lwaDM3eGZyZXg5TFpRZnVjYWRNK0ZISUlnQnpmYks3Wm12QnhReWwxTWFsSkgwQVIrZ3hoNHFEeGZETQpXaVRhQk85eDdvNWpDK3NHMm82V29zcGs5VE1qNnZzbHNlZ0xKbys1VnJ2alVFa0tCNWpnZlNCM1FPanJ5d1p0Cmx4bW1tR2hxVkppQjMyaE56WnZaZ2x0UXZ6M0d2aFhVTFgzYgotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg=="
          },
          "clientRequestToken" : null,
          "platformVersion" : "eks.5",
          "tags" : { },
          "encryptionConfig" : [ {
            "resources" : [ "secrets" ],
            "provider" : {
              "keyArn" : "arn:aws:kms:us-east-1:476384142167:key/mrk-723d1002db9e4abaaf53ec97343f6df6"
            }
          } ],
          "connectorConfig" : null
        }
      },
      "supplementaryConfiguration" : {
        "fargateProfiles" : [ ],
        "nodegroups" : [ ],
        "updates" : [ ]
      },
      "tags" : { },
      "discoveryMeta" : { }
    } ]
