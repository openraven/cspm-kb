id: 74406460-05fb-4057-b646-f3f8c1e5d56f
refId: aws-security-best-practices
name:  AWS Security Best Practices
cloudProvider: AWS
description: >
  Source: Custom Open Raven Policy for Magpie based on the product version of this policy.

  AWS Security Best Practices policy analyzes accounts for security best practices
  and is modelled on guidance published by the Center for Information Security.
enabled: true
ruleIds:
  - aws-iam-and-security-iam-users-w-password-mfa-enabled.yaml
  - aws-iam-and-security-iam-user-unused-credentials-check.yaml
  - aws-iam-and-security-ensure-access-keys-are-rotated-every-90-days-or-less.yaml
  - aws-iam-and-security-ensure-iam-password-policy-requires-one-uppercase-letter.yaml
  - aws-iam-and-security-ensure-iam-password-requires-one-lowercase-letter.yaml
  - aws-iam-and-security-iam-password-policy-symbols.yaml
  - aws-iam-and-security-ensure-iam-password-requires-one-number.yaml
  - aws-iam-and-security-iam-password-policy-length.yaml
  - aws-iam-and-security-iam-password-policy-reuse.yaml
  - aws-iam-and-security-ensure-iam-password-policy-expires-password-90-days-or-less.yaml
  - aws-iam-and-security-ensure-no-root-account-access-key-exists.yaml
  - aws-iam-and-security-ensure-mfa-enabled-for-root-account.yaml
  - aws-iam-and-security-iam-user-no-policies-check.yaml
  - aws-iam-and-security-ensure-support-role-is-created-to-manage-incidents-with-aws-support.yaml
  - aws-iam-and-security-no-default-access-keys-with-console-password-for-all-iam-users.yaml
  - aws-management-tools-cloudtrail-cloudwatch-logs-enabled.yaml
  - aws-iam-and-security-cmk-backing-key-rotation-enabled.yaml
  - aws-compute-elastic-compute-security-groups-ip.yaml
  - aws-iam-and-security-no-security-groups-allow-all-ingress-to-port-3389.yaml
#  - aws-vpc-rooting-access.yaml
  - aws-iam-and-security-ensure-access-keys-are-rotated-every-90-days-or-less.yaml
  - aws-iam-and-security-cmk-backing-key-rotation-enabled.yaml
  - aws-management-tools-ensure-s3-bucket-access-logging-is-enabled-on-cloudtrail-s3-bucket.yaml
  - aws-storage-s3-bucket-cloudtrail-logs.yaml
  - aws-storage-s3-bucket-has-no-server-side-encryption-being-enabled-by-another-account.yaml
  - aws-storage-s3-bucket-level-public-access-prohibited.yaml
  - aws-storage-s3-bucket-deny-overriding-of-default-kms-key-encryption.yaml
  #- aws-storage-s3-bucket-versioning-enabled.yaml
#  - aws-iam-and-security-ensure-security-contact-information-is-registered.yaml
  # 56 missing - ransomware C2 rule
  - aws-management-tools-securityhub-enabled-for-required-region.yaml
  - aws-compute-ec2-instance-managed-by-systems-manager.yaml
  - aws-iam-and-security-ensure-support-role-is-created-to-manage-incidents-with-aws-support.yaml
  - aws-management-tools-cloudtrail-cloudwatch-logs-enabled.yaml
  #   newly added rules michael + tara.
  - aws-management-tools-cloudtrail-security-trail-enabled.yaml
  - aws-management-tools-cloudtrail-s3-dataevents-enabled.yaml
  - aws-compute-ec2-instance-detailed-monitoring-enabled.yaml
  - aws-compute-ec2-imdsv2-check.yaml
  - aws-management-tools-cloudwatch-alarm-action-check.yaml
  - aws-application-services-sns-encrypted-kms.yaml
  - aws-database-redshift-cluster-kms-enabled.yaml
  - aws-storage-s3-bucket-default-lock-enabled.yaml
  - aws-database-rds-logging-enabled.yaml
  - aws-iam-and-security-iam-user-mfa-enabled.yaml
  - aws-database-rds-multi-az-support.yaml
  - aws-database-rds-instance-deletion-protection-enabled.yaml
  - aws-big-data-and-analytics-elasticsearch-logs-to-cloudwatch.yaml
  - aws-database-redshift-backup-enabled.yaml
  - aws-database-rds-instance-iam-authentication-enabled.yaml
  - aws-database-rds-cluster-iam-authentication-enabled.yaml
  - aws-database-dynamodb-table-encrypted-kms.yaml
  - aws-database-dynamodb-pitr-enabled.yaml
  - aws-database-dynamodb-autoscaling-enabled.yaml
  - aws-database-dynamodb-resources-protected-by-backup-plan.yaml
  - aws-database-rds-enhanced-monitoring-enabled.yaml
  - aws-database-rds-cluster-deletion-protection-enabled.yaml
  - aws-database-dynamodb-table-encryption-enabled.yaml
  - aws-database-rds-storage-encrypted.yaml
  - aws-database-rds-snapshot-encrypted.yaml
  - aws-database-rds-cluster-multi-az-enabled.yaml
  - aws-database-rds-automatic-minor-version-upgrade-enabled.yaml
  - aws-database-rds-instance-public-access-check.yaml
  - aws-database-rds-db-instance-backup-enabled.yaml
  - aws-database-rds-aurora-mysql-backtracking-enabled.yaml
  - aws-database-redshift-cluster-public-access-check.yaml
  - aws-database-redshift-cluster-configuration-check.yaml
  - aws-database-dynamodb-covered-by-backup-plan.yaml
  - aws-database-rds-covered-by-backup-plan.yaml
  - aws-storage-fsx-resources-protected-by-backup-plan.yaml
  - aws-network-and-content-delivery-elb-logging-enabled.yaml
  - aws-database-redshift-enchanced-vpc-routing-enabled.yaml
  - aws-big-data-and-analytics-elasticsearch-node-to-node-encryption.yaml
  - aws-storage-s3-server-side-encryption.yaml
  #- aws-storage-s3-versioning-enabled.yaml
  - aws-management-tools-cloudwatch-log-group-encrypted.yaml
  - aws-database-redshift-cluster-maintenancesettings-check.yaml
  - aws-disaster-recovery-services-backup-recovery-point-encrypted.yaml
    #- aws-security-and-identity-compliance-secrets-manager-using-cmk.yaml
  - aws-compute-eks-secrets-encrypted.yaml
  - aws-compute-eks-endpoint-no-public-access.yaml
  - aws-security-and-identity-compliance-kms-cmk-not-scheduled-for-deletion.yaml
  - aws-storage-efs-encrypted-check.yaml
  - aws-storage-efs-in-backup-plan.yaml
  #- aws-database-rds-in-backup-plan.yaml
  - aws-security-and-identity-compliance-secretsmanager-rotation-enabled-check.yaml
  - aws-security-and-identity-compliance-secretsmanager-secret-periodic-rotation.yaml
  - aws-security-and-identity-compliance-secretsmanager-secret-unused.yaml
  - aws-compute-lambda-inside-vpc.yaml
  - aws-compute-lambda-dlq-check.yaml
  - aws-compute-lambda-concurrency-check.yaml
  - aws-compute-ec2-instances-in-vpc.yaml
  - aws-compute-ec2-instance-no-public-ip.yaml
  - aws-compute-ec2-managedinstance-platform-check.yaml
  - aws-compute-ec2-instance-profile-attached.yaml
  - aws-compute-ec2-volume-inuse-check.yaml
  - aws-compute-ec2-ebs-encryption-by-default.yaml
  - aws-compute-ec2-stopped-instance.yaml
  - aws-compute-ec2-instance-multiple-eni-check.yaml
  - aws-compute-ebs-optimized-instance.yaml
  - aws-compute-ebs-encrypted-volumes.yaml
  - aws-network-and-content-delivery-cloudfront-viewer-policy-https.yaml
  - aws-network-and-content-delivery-cloudfront-sni-enabled.yaml
  - aws-network-and-content-delivery-cloudfront-origin-failover-enabled.yaml
  - aws-network-and-content-delivery-cloudfront-origin-access-identity-enabled.yaml
  - aws-network-and-content-delivery-cloudfront-associated-with-waf.yaml
  - aws-iam-and-security-default-security-group-for-vpc-restricts-all-traffic.yaml
  - aws-network-and-content-delivery-elb-deletion-protection-enabled.yaml
