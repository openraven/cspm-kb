# id: acffd4d7-0fe4-4750-a155-6c6fc35f133f
ruleId: aws-storage-s3-bucket-level-public-access-prohibited
type: asset
ruleName: >
  Ensure that S3 Bucket restrict public access by ACL and policy
description: >
  S3 Buckets should not be reachable outside of the project by default,
  violation if that rule could cause major vulnerabilities and data loss
severity: high
enabled: true
sql: >
  SELECT arn
    FROM ${magpie_schema}.awss3bucket
     AND (supplementaryconfiguration ->> 'isPublicByACL' <> 'false'
        OR supplementaryconfiguration ->> 'isPublicByPolicy' <> 'false')

remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9
