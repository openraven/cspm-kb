ruleId: aws-security-and-identity-compliance-secretsmanager-secret-periodic-rotation
type: asset
ruleName: >
  Ensure AWS Secrets Manager secrets have been rotated in the past specified number of days
description: >
  Checks if AWS Secrets Manager secrets have been rotated in the past specified number of days. The rule is non compliant if rotation hasn't occured in 90 days
severity: high
enabled: true
sql: >
  SELECT arn
  FROM ${magpie_schema}.awssecretsmanager
  WHERE (TO_TIMESTAMP(configuration ->> 'lastRotatedDate', 'YYYY-MM-DD"T"HH24:MI:SS') < now() - interval '90 days')
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9
