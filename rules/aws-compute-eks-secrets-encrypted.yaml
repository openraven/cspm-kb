ruleId: aws-compute-eks-secrets-encrypted
type: asset
ruleName: >
  Ensure Amazon Elastic Kubernetes Service lusters are configured to have secrets encrypted using KMS keys.
description: >
  Checks whether Amazon EKS clusters are configured to have Kubernetes secrets encrypted with KMS keys. his rule is COMPLIANT if an EKS cluster has an encryptionConfig with secrets as one of the resources.
severity: high
enabled: true
sql: >
  SELECT arn
  FROM ${magpie_schema}.awsekscluster
  WHERE (configuration -> 'cluster' -> 'encryptionConfig' = 'null');
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9
