# id: 12ac08c9-9309-44d4-b6ae-98d15db5becd
# opnrvn-r-13
ruleId: aws-iam-and-security-ensure-iam-password-policy-expires-password-90-days-or-less
type: asset
ruleName: >
  Ensure IAM password policy expires passwords within 90 days or less
description: >
  IAM password policies can require passwords to be rotated or expired after a given
  number of days. It is recommended that the password policy expire passwords after 90
  days or less
severity: high
enabled: true
sql: >
  SELECT resourcename as arn
  FROM ${magpie_schema}.awsaccount
  WHERE resourcetype = 'AWS::Account'
    AND (supplementaryconfiguration-> 'PasswordPolicy' = 'null'
       OR supplementaryconfiguration->'PasswordPolicy'->'maxPasswordAge' = 'null'
       OR supplementaryconfiguration->'PasswordPolicy'->'maxPasswordAge' > '90');
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9
