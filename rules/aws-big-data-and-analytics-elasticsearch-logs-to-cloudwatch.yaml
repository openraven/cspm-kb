# opnrvn-r-157
ruleId: aws-big-data-and-analytics-elasticsearch-logs-to-cloudwatch
type: asset
ruleName: >
  Ensure Amazon OpenSearch Domains have logging enabled to send logs to Amazon CloudWatch logs.
description: >
  Checks if Amazon OpenSearch Service (OpenSearch Service) domains are configured to send logs to Amazon CloudWatch Logs. The rule is COMPLIANT if a log is enabled for an OpenSearch Service domain. This rule is NON_COMPLIANT if logging is not configured.
severity: high
enabled: true
sql: >
  SELECT arn
  FROM ${magpie_schema}.awselasticsearchdomain
  WHERE (configuration -> 'logPublishingOptions' = 'null');
remediationDocURLs: https://github.com/openraven/security-rules/wiki
version: 0.9
